---
title: '논문작성을 위한 R통계분석: Statistical analysis of papers WithR'
author: "Park Joonghee (Yonsei University coginitive Eng. lab)"
date: "2023-12-16"
output:
  word_document: default
  html_notebook: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
	#word_document
)
# source("SEM2.1.2.R")
# source("F:/SEM2.1.2.R")
source("D:/SEM2.1.2.R")
```

# 연구방법과 통계분석

**저자의 말**

이 책에서 다루고자 하는 것은 실제로 논문을 집필하거나 혹은 통계분석을 하고자 하는 경우에 실질적으로 필요한 부분과 집중해야할 부분을 담았다. 연구자로서 직접 분석을 하고 자신의 연구를 정밀하게 담고 싶은 마음은 정말 간절할 것이다. R은 무료로 이 모든 것을 가능하게 해주며, 배우는 것도 그리 어려운 것은 아니다. 그러나, R을 이용하여 통계분석을 하고자 하는 경우, 너무 기초에 매달리다보니 실제로 필요한 것을 익히는데 너무 올래걸리는 것이 현실이다. 연구자들에게 통계분석만을 목적으로 사용한다면 너무 어려운 것은 아님에도 불구하고 코드(syntax)방식이라는 이유로 벽에 부딪히는 경우가 많다. 그러나, 연구를 재현하는 관점에서 접근해보면 이러한 코드형태로 사용하는 방식은 매우 편리한 방법임에는 그 누구도 부인할 수 없다.\
본 책에서는 논문 통계분석의 절차에 따라서 사용하는 R함수와 라이브러리를 소개하여 분석하는 다양한 방법을 소개하면서 R을 익힐 수 있게 하고 있다. 함수를 일일이 기억하는 것은 매우 어려운 일이지만 상황에 맞추어서 최적의 함수를 사용하는 것은 경험으로서 기억이 잘 나고 찾아볼 수 있으므로 그러한 방식으로 분석방법을 소개하려고 한다. 분석후에는 간단하게라도 가능한 APA양식에 맞추어서 보고하는 방식을 소개하고 있다.
\
\


# 1. 데이터에 대한 이해

## 1. 논문을 위한 기본 개념

-   연구주제의 선정

-   연구가설과 연구모형\




# 2. 기초통계분석

## 2.1. 연구에 관한 이해

-   연구가설과 귀무가설

-   제 1종오류와 2종 오류

-   유의수준과 신뢰수준, 유의확률

-   통계적 의사결정 



## 2.2. 데이터의 처리와 이해

\
-변수변환 처리 recode 
- 역코딩 방법 


# 3. 기본 통계분석

\

## 3.1. ㅣ기술통계(Descriptive statistics)

기본적인 분석은 가장 먼저 해야할 분석을 말한다.\
대푯값과 산포도를 중심으로 분석하게 된다. 대표값에는 평균, 중앙값, 최빈값을 분석하게 되는데  평균은 mean(), 중앙값은 median(), 최빈값은 table()을 사용하여 분석한다. \


### 3.1.1. 빈도분석

먼저 R에 기본으로 탑재된 mtcars 데이터를 이용하여 빈도분석을 해보자.\
데이터의 구조는 다음과 같다.\
이 데이터는 1974년 미국 Motor Trend US 잡지에서 추출된 자료로 32개의 자동차회사의 1973년\~1974년 모델에 대한 자동차의 10가지의 디자인 및 성능에 대한 연료 소비량(mpg)를 나타낸 자료이다.\
\
A data frame with 32 observations on 11 (numeric) variables.\
[, 1] mpg Miles/(US) gallon\
[, 2] cyl Number of cylinders\
[, 3] disp Displacement (cu.in.)\
[, 4] hp Gross horsepower\
[, 5] drat Rear axle ratio\
[, 6] wt Weight (1000 lbs)\
[, 7] qsec 1/4 mile time\
[, 8] vs Engine (0 = V-shaped, 1 = straight)\
[, 9] am Transmission (0 = automatic, 1 = manual)\
[,10] gear Number of forward gears\
[,11] carb Number of carburetors\
\
데이터의 구조를 보는 좋은 방법중 하나가 str()함수를 사용하는 것이다.

```{r}
library(tidyverse)  # dplyr: %>% (pipe)
data(mtcars)
mtcars %>% str()  # same as str(mtcars)
```

#### 3.1.1.1. table()

논문의 분석을 시작할 때, 항상 설문이나 실험참가자의 빈도분석을 통해서 제시하게 되어있는데, 이때 사용하는 것이 table함수이다.\
빈도분석은 보통 table()함수를 활용하는 경우가 많다. 빈도분석은 입력된 데이터들이 도수분포표(frequency table)상에서 어떠한 분포적 특성을 가지고 있는지 파악하는 데 사용된다.\

mtcars의 am변수는 Transmission을 나타낸다 (0 = automatic, 1 = manual).\
따라서, 먼저 변수를 factor처리를 먼저해서 빈도를 분석해보자.

```{r}
# mtcars$am
data(mtcars)
mtcars$am <- factor(mtcars$am,
                    level = c(0, 1),
                    labels = c("automatic", "manual" ))
# frequency analysis
table(mtcars$am)
```

분석된 결과는 다음과 같이 설명한다.\
빈도분석결과, 자동차의 트랜스미션(transmission)에 대하여 오토매틱은 19개, 수동은 13개로 나타났다.\
이번에는 엔진(engine)에 대한 빈도분석을 해보자.

```{r}
mtcars$vs <- factor(mtcars$vs, level=c(0, 1),
                    labels = c("V-shaped", "straight" ) )
table(mtcars$vs)
```

트랜스미션(transmission)별 엔진(Enigne)의 빈도분석을 해보자. 이는 table(변수1, 변수2)를 넣으면 분석이 된다. 행렬(matrix)의 형태로 빈도를 볼 수 있다.

```{r}
table(mtcars$am, mtcars$vs)
```

그런데 이러한 방법이 아닌 목록으로 정리하여 보고 싶다면 데이터프레임(data.frame)으로 변경하면 목록형태로 나타나서 논문표에서 넣기 더 편할 수 있다.

```{r}
data.frame(table(mtcars$am, mtcars$vs))
```

#### 3.1.1.2. count(), n()

R을 사용하는 경우 다양한 라이브러리(library)를 사용할 수 있기 때문에 분석하는 방법이 한가지로 고정되어 있는 것은 아니다. 사용하는 라이브러리를 이용하여 다양한 분석을 할 수 있다. 먼저. dplyr패키지를 이용하여 나타내는 방법도 매우 유용하다. dplyr::count()는 매우 편리한 함수이다. 사용방법은 count(데이터, 변수)로 입력하여 사용한다.

```{r}
count(mtcars, am)
# mtcars %>% count(am)
```

```{r}
count(mtcars, am, vs)
```



좀 불편할 수 있으나, 실제 활용도가 높은 것중 하나가 n()이다. 빈도분석하는 과정에서 수시로 사용회는 함수인데, summarise()와 함께 사용하는 유용한 함수이다.\
summarise()와 n()을 이용하여 다음과 같이 나타낼 수 있다.

```{r}
mtcars %>% group_by(am)%>% summarise(N=n())
```

#### forcats::fct_count()

이번에는 forcats라는 라이브러리의 fct_count()이다. 
필자의 경우도 매우 자주 사용하고 애용하는 라이브러리함수이다. 그 이유는 여러가지로 변형이 가능하기 때문이다. 그러나, fct_count()는 vector형식으로 한가지 변수만 분석이 가능하다. 출력은 tibble데이터로 출력되어 table()와는 다른 형식으로 출력된다. 
fct_count(데이터)를 입력하면 되고, 옵션으로는 sort를 이용한 정렬기능과 prop라는 비율을 나타내는 옵션이 있다.\
먼저 일반적인 빈도분석이다.\

```{r}
#frequency analysis : default option 
library(forcats)
forcats::fct_count(mtcars$am)
```

이번에는 각 빈도에 비율을 포함시켜보자.\

```{r}
# add proportion 
forcats::fct_count(mtcars$am, prop=TRUE)
```

- 시각화 
```{r fig.width= 2, fig.height=2}
fct_count(mtcars$am) %>% 
  ggplot(aes(x=f, y=n))+
  geom_bar(stat="Identity")+
  geom_text(aes(label=n), vjust=-.5)+
  labs(x="transmission", y="frequency")+
  ylim(0, 23)
```





#### 빈도의 수가 0인 경우 출력하는 방법

빈도수가 0인 것을 출력해야 하는 경우는 다양한 변수별로 빈도를 분석해서 데이터를 병합할 때 컬럼의 개수가 맞지 않으면 병합하기 어렵기 때문이다. 리커트 척도로 5개의 척도에 대하여 빈도를 분석한 경우, 0이라고 출력하지 않으면 어떤 것은 3개, 4개, 5개로 달라지기 때문에 병합할 수 없게 된다. 따라서, 빈도가 0으로 나와도 출력을 해주어야 하는 경우가 발생한다. 

```{r}
y <- c(0, 0, 0, 3, 4, 4, 4, 4)
z <- c(0, 0, 1, 3, 4, 5, 5, 5)
table(y)
```
0에서 5까지의 변수중에서 개수를 센 상태인데, 2의 경우는 0개이다. 그런데 이 경우 2와 5가 0이라고 나타내고 싶은 경우는 factor로 처리하면서 2를 세도록 해야 한다. 
```{r}
table(factor(y, levels = 0:5))
```
이것은 fct_count()에서도 동일하다
```{r}
y <- c(0, 0, 0, 3, 4, 4, 4, 4)
#2가 0개에서 표시가 안된 경우 
fct_count(factor(y))

```
2를 0개라고 표시한 경우이다. \
이를 시각화해보면 막대그래프가 4개가 그려지면서 실제 빈도수가 나타난다. 
```{r}
y <- c(0, 0, 0, 3, 4, 4, 4, 4)
fct_count(factor(y))%>% 
  ggplot(aes(x=f, y=n))+
  geom_bar(stat="Identity")+
  geom_text(aes(label=n), vjust=-.5)
```



```{r}

#2를 0개라고 표시한 경우 
fct_count(factor(y, level=0:5))
```
이것을 다시 시각화해보자. 
```{r}
fct_count(factor(y, level=0:5)) %>% 
  ggplot(aes(x=f, y=n))+
  geom_bar(stat="Identity")+
  geom_text(aes(label=n), vjust=-.5)
```








-   사용자 함수만들어서 빈도분석하기\
    \
    \

### 3.1.2 기술통계분석 

#### 3.1.2.1 대푯값  
대푯값에는 평균, 중앙값, 최빈값등이 있다. 평균을 구할 때에는 mean(), 중앙값은 median(), 최빈값을 구할 때에는 table()을 사용하는 것이 일반적이다. \



### 3.1.3. 정규성 검정
\


## 3.2. 척도분석 

### 3.2.1. 신뢰도 분석 
reliability 


### 3.2.2. 요인 분석 
- 탐색적 요인 분석 
- 확인적 요인 분석 
지표 타당도
복합 신뢰도 
수렴 타당성
판별 타당성 


## 3.3. t-test
### 3.3.1 일표본 t검정(onesample t.test)

하나의 표본을 이용하여 모집단의 특정한 값과 같은지 추론하는 방법이다. 만약에 음료수를 사먹는데, 평균용량이 1L라고 할 때, 진짜 평균적으로 1L인지 샘플을 추출하여 평균을 구하여 일표본 t검정을 수행하면 된다.

검정에 필요한 t값은 다음과 같이 계산한다.

$$ t = \frac{m-\mu}{\frac{s}{\sqrt{n}}}$$ $\mu$는 평균, n:샘플사이즈, s:샘플의 표준편차

결과를 해석할 때에는 p값을 기준하여 설명하면 된다. \$ p \< .05\$이면 귀무가설을 기각하고 대립가설을 받아들인다. 즉, 표본평균은 이론적 평균과 유의하게 다르다는 결론을 내릴 수 있다.








### 3.3.2 독립표본 t검정 
- 두변수간 평균 비교
- 두 집단간 평균 비교 

- 등분산성 검정 
 영가설: 등분산을 이루고 있다. p >.05. \
 대립가설: 등분산을 이루지 않는다 p< .05.\
 
```{r}

 var.test(mpg~vs,mtcars)

```


### 3.3.3. 대응표본 t검정 

## 3.4. ANOVA

## 반복측정 분산 분석 

## MANOVA(다변량 분석)

## ANCOVA 공분산 분석 

## 3.5. Chi-square test 
독립성 검정과 동질성 검정 

## 3.6. Correlation 


## 3.7. Regression 

###  OLS 회귀분석 
### 로지스틱 회귀분석 



# 4. 응용통계분석(1) 

## 4.1. 경로 분석 


## 4.2. 매개효과 분석 


## 4.3. 조절효과 분석 


## 4.4. Process Macro



# 5. 구조방정식 모형 



# 6. PLS 구조 방정식 모형 


# 7. 다변량 분석 
## 주성분 분석 
## 인자분석 
 
## 7.1. 다차원 척도법 

## 7.2. 대응일치분석 

## 7.3. 군집 분석 

## 7.4. 잠재프로파일 분석 

## 형상 분석 

## 소셜네트워크 분석 

## 연관분석 















