epal.aov %>% anova()
#marginal means #####
library(emmeans)
epal.aov <- aov(AveragePleasantness ~ grp, epal_o)
epal.aov %>% anova()
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
geom_text(aes(label=AveragePleasantness))
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
geom_text(aes(label=mean(AveragePleasantness)))
geom_text(aes(label=mysummaryBy(AveragePleasantness ~ grp, epal_o) %>% select(Mean ))
#boxplot
ggplot(epal_o,
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()
epal_o1$grp %>% mysummaryBy(AveragePleasantness ~ grp)
epal_o1$grp %>% mysummaryBy(formula=AveragePleasantness ~ grp)
epal_o1 %>% mysummaryBy(formula=AveragePleasantness ~ grp)
epal_o1 %>% mysummaryBy(formula=AveragePleasantness ~ grp)[,"Mean"]
epal_o1 %>% mysummaryBy(formula=AveragePleasantness ~ grp) %>% select()Mean
epal_o1 %>% mysummaryBy(formula=AveragePleasantness ~ grp) %>% select(Mean)
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp) %>% select(Mean)
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
geom_text(aes(label = mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp) %>% select(Mean)))
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
labs(title ="그룹별 비교 Boxplot")
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)[,1,2]
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)[,c(1,2)]
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)[,c(1:3)]
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)[,c(1:4)]
epal.em <- emmeans(epal.aov, "grp")
epal.em
#이방법도 가능
emmeans(epal.aov, ~grp)
epal.em <- emmeans(epal.aov, "grp")
epal.em
#이방법도 가능
emmeans(epal.aov, ~grp)
epal.em <- emmeans(epal.aov, "grp")
epal.em
#이방법도 가능
# emmeans(epal.aov, ~grp)
DescribeBy(epal_o1, formula=AveragePleasantness ~ grp)[,c(1:4)]
DescribeBy(epal_o1, formula=AveragePleasantness ~ grp)#[,c(1:4)]
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
labs(title ="그룹별 비교 Boxplot")
myssummaryBy(epal_o1, formula=AveragePleasantness ~ grp)#[,c(1:4)]
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)[,c(1:4)]
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)
"그룹별 비교 Boxplot" %>% e()
"그룹별 비교 Boxplot" %>% g()
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
labs(title ="Comparison Boxplot by group")
#contrast coeff
contr = list(
"interation: m1-m2-m3+m4=0"   = c(1, -1, -1, 1),
"Con of Female: m1-m2=0"     = c(1, -1, 0, 0),
"con of Male: m3-m4-0"       = c(0, 0, 1, -1),
"Gender of Abstract: m1-m3=0"= c(1, 0, -1, 0),
"Gender of Nudes: m2-m4=0"   = c(0, 1, 0, -1))
contr
#result
contrast(epal.em,contr,adjust = "none")
#result
contrast(epal.em,contr,adjust = "none") %>% kable("pandoc")
#result
contrast(epal.em,contr,adjust = "none")
contrast(epal.em,contr,adjust = "none") %>% p_mark_sig()
epal.plot %>%
select(1:3) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness") +#상호작용 그래프
labs(linetype ="condition", col="Condition")
epal.plot <-  Erotic_picture_love %>%
group_by(Gender, Condition) %>%
summarise(AP.Mean = mean(AveragePleasantness),
SD = sd(AveragePleasantness),
N=n())
epal.plot <- epal.plot %>% mutate_if(is.numeric, round, 2)
epal.plot %>% head()
#emmip_interaction plot method 2
epal.aov <- aov(AveragePleasantness ~ Gender*Condition, Erotic_picture_love)
# epal.aov %>% anova()
epal.aov %>% summary()
epal.plot %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness") +#상호작용 그래프
labs(linetype ="condition", col="Condition")
epal.plot %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness") +#상호작용 그래프
labs(linetype ="condition")
epal.plot %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness") +#상호작용 그래프
labs(linetype ="condition")+
ylim(4,5.8)
epal.plot %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness") +#상호작용 그래프
labs(linetype ="condition")+
ylim(4.1,5.8)
epal.plot %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness") +#상호작용 그래프
labs(linetype ="condition")+
ylim(4.1,5.6)
epal.plot %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness") +#상호작용 그래프
labs(linetype ="condition")
#emmip_interaction plot method 2
epal.aov <- aov(AveragePleasantness ~ Gender*Condition, Erotic_picture_love)
# epal.aov %>% anova()
epal.aov %>% summary()
#emmip_interaction plot method 2
epal.aov <- aov(AveragePleasantness ~ Gender*Condition, Erotic_picture_love)
# epal.aov %>% anova()
epal.aov %>% summary()
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love)
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
#emmip_interaction plot method 2
epal.aov <- aov(AveragePleasantness ~ Gender*Condition, Erotic_picture_love)
# epal.aov %>% anova()
epal.aov %>% summary()
epal.aov %>% report_aov()
##plot
emmip.data <- emmeans::emmip(epal.aov, Condition ~ Gender )
#CIs
emmeans::emmip(epal.aov,
Condition ~ Gender,
CIs=TRUE )+
geom_text(aes(y = yvar + 0.1, label = round(yvar , 2)), hjust = -.5)
#oneway anova를 위한 데이터 그룹생성
epal_o1 <- Erotic_picture_love %>% arrange(Gender, Condition) %>%
mutate(grp = case_when(
Gender=="Female"& Condition=="Abstract Art" ~ "g1_FA",
Gender=="Female"& Condition=="Nudes"       ~ "g2_FN",
Gender=="Male"& Condition =="Abstract Art" ~ "g3_MA",
Gender=="Male"& Condition =="Nudes"        ~ "g4_MN"  )
)
#생성한 데이터의 그룹별 빈도수
epal_o1$grp %>% table()
mysummaryBy(epal_o1, formula=AveragePleasantness ~ grp)
mysummaryBy(epal_o1, AveragePleasantness ~ grp)
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
labs(title ="Comparison Boxplot by group")
#marginal means #####
library(emmeans)
epal.aov <- aov(AveragePleasantness ~ grp, epal_o)
epal.aov %>% anova()
epal.em <- emmeans(epal.aov, "grp")
epal.em
#이방법도 가능
# emmeans(epal.aov, ~grp)
contrast(epal.em,contr,adjust = "none") %>%
p_mark_sig()
#result
contrast(epal.em,contr,adjust = "none")
contrast(epal.em,contr,adjust = "none") %>%
confint()%>%
confint_mark_sig()
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
#word_document
)
setwd("F:/Rwork/04_Book/book1")
library(rstatix)
# devtools::install_github("shoutjoy/jjstat")
library(jjstat)  # statistical summary
library(knitr)
Erotic_picture_love <- jjstat::Erotic_picture_love
Erotic_picture_love |> str()
#A 2 (Gender: Male, Female) x 2 (Condition: Art, Nudes) ANOVA on pleasantness of the stimuli shows an interaction between Gender and Condition.
aov(AveragePleasantness ~ Gender*Condition, data =  Erotic_picture_love,
contrasts = list(Gender = contr.sum, Condition = contr.sum)) %>%
rstatix::Anova(type =3) %>%  round(3)
aov(AveragePleasantness ~ Gender*Condition, data =  Erotic_picture_love) %>%
report_aov()
epal.plot <-  Erotic_picture_love %>%
group_by(Gender, Condition) %>%
summarise(AP.Mean = mean(AveragePleasantness),
SD = sd(AveragePleasantness),
N=n())
epal.plot <- epal.plot %>%
mutate_if(is.numeric, round, 2)  # 변수가 numeric인 경우만 round처리
epal.plot %>% head()
#emmip_interaction plot method 2
epal.aov <- aov(AveragePleasantness ~ Gender*Condition, Erotic_picture_love)
# epal.aov %>% anova()
epal.aov %>% summary()
#oneway anova를 위한 데이터 그룹생성
epal_o1 <- Erotic_picture_love %>% arrange(Gender, Condition) %>%
mutate(grp = case_when(
Gender=="Female"& Condition=="Abstract Art" ~ "g1_FA",
Gender=="Female"& Condition=="Nudes"       ~ "g2_FN",
Gender=="Male"& Condition =="Abstract Art" ~ "g3_MA",
Gender=="Male"& Condition =="Nudes"        ~ "g4_MN"  )
)
#생성한 데이터의 그룹별 빈도수
epal_o1$grp %>% table()
epal.em <- emmeans(epal.aov, "grp")
#marginal means #####
library(emmeans)
epal.aov <- aov(AveragePleasantness ~ grp, epal_o)
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
labs(title ="Comparison Boxplot by group")
#oneway anova를 위한 데이터 그룹생성
epal_o1 <- Erotic_picture_love %>% arrange(Gender, Condition) %>%
mutate(grp = case_when(
Gender=="Female"& Condition=="Abstract Art" ~ "g1_FA",
Gender=="Female"& Condition=="Nudes"       ~ "g2_FN",
Gender=="Male"& Condition =="Abstract Art" ~ "g3_MA",
Gender=="Male"& Condition =="Nudes"        ~ "g4_MN"  )
)
#생성한 데이터의 그룹별 빈도수
epal_o1$grp %>% table()
mysummaryBy(epal_o1, AveragePleasantness ~ grp)
mysummaryBy(epal_o1, AveragePleasantness ~ grp)
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
labs(title ="Comparison Boxplot by group")
#oneway anova를 위한 데이터 그룹생성
epal_o <- Erotic_picture_love %>% arrange(Gender, Condition) %>%
mutate(grp = case_when(
Gender=="Female"& Condition=="Abstract Art" ~ "g1_FA",
Gender=="Female"& Condition=="Nudes"       ~ "g2_FN",
Gender=="Male"& Condition =="Abstract Art" ~ "g3_MA",
Gender=="Male"& Condition =="Nudes"        ~ "g4_MN"  )
)
#생성한 데이터의 그룹별 빈도수
epal_o$grp %>% table()
mysummaryBy(epal_o1, AveragePleasantness ~ grp)
#boxplot
ggplot(epal_o,
aes(x = grp,y = AveragePleasantness))+
geom_boxplot()+
labs(title ="Comparison Boxplot by group")
#marginal means #####
library(emmeans)
epal.aov <- aov(AveragePleasantness ~ grp, epal_o)
epal.aov %>% anova()
epal.em <- emmeans(epal.aov, "grp")
epal.em
#이방법도 가능
# emmeans(epal.aov, ~grp)
#contrast coeff
contr = list(
"interation: m1-m2-m3+m4=0"   = c(1, -1, -1, 1),
"Con of Female: m1-m2=0"     = c(1, -1, 0, 0),
"con of Male: m3-m4-0"       = c(0, 0, 1, -1),
"Gender of Abstract: m1-m3=0"= c(1, 0, -1, 0),
"Gender of Nudes: m2-m4=0"   = c(0, 1, 0, -1))
contr
#result
contrast(epal.em,contr,adjust = "none")
contrast(epal.em,contr,adjust = "none") %>%
p_mark_sig()
contrast(epal.em,contr,adjust = "none") %>%
p_mark_sig(unite=TRUE)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
#word_document
)
setwd("F:/Rwork/04_Book/book1")
library(rstatix)
# devtools::install_github("shoutjoy/jjstat")
library(jjstat)  # statistical summary
library(knitr)
interplot_data(6,7,4,5, type="plot")
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
#word_document
)
setwd("F:/Rwork/04_Book/book1")
library(rstatix)
# devtools::install_github("shoutjoy/jjstat")
library(jjstat)  # statistical summary
library(knitr)
knitr::opts_chunk$set(
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
#word_document
)
setwd("F:/Rwork/04_Book/book1")
library(rstatix)
# devtools::install_github("shoutjoy/jjstat")
library(jjstat)  # statistical summary
library(knitr)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE, yadd=0.5)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE, yadd = 0.6)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE, yadd = 10)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE, yadd = 30)
?interplot_data
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy = FALSE,
yadd = 20)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy = FALSE,
yadd = 10)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE,
yadd = 30)
interplot_data( 60, 40, 50, 30, 20,20, row = 3, col=2, type="plot" , xy = TRUE,
yadd=10)
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
#word_document
)
setwd("F:/Rwork/04_Book/book1")
library(rstatix)
# devtools::install_github("shoutjoy/jjstat")
library(jjstat)  # statistical summary
library(knitr)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE,
yadd = 30)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE,
yadd = 10)
interplot_data(98,40,98,60, 98, 80, row = 3, col=2, type="plot" , xy=TRUE,
yadd = 5)
interplot_data( 60, 40, 50, 30, 20,20, row = 3, col=2, type="plot" , xy = TRUE,
yadd=10)
interplot_data( 60, 40, 50, 30, 20,20, row = 3, col=2, type="plot" , xy = TRUE,
yadd=5)
interplot_data( 60, 40, 50, 30, 20,20, row = 3, col=2, type="plot" ,
xy = FALSE, yadd=5)
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
#interaction plot####method 1
epal.plot   %>% ggplot(aes(x = Gender,y = AP.Mean))+
geom_point(aes(col = Condition, shape = Condition),
size = 4)+
geom_line(aes(group = Condition, col = Condition, lty = Condition),
lwd = 1.2)+
geom_text(aes(y = AP.Mean+0.1,
label= round(AP.Mean,2)))
epal.plot <-  Erotic_picture_love %>%
group_by(Gender, Condition) %>%
summarise(AP.Mean = mean(AveragePleasantness),
SD = sd(AveragePleasantness),
N=n())
epal.plot <- epal.plot %>%
mutate_if(is.numeric, round, 2)  # 변수가 numeric인 경우만 round처리
epal.plot %>% head()
#interaction plot####method 1
epal.plot   %>% ggplot(aes(x = Gender,y = AP.Mean))+
geom_point(aes(col = Condition, shape = Condition),
size = 4)+
geom_line(aes(group = Condition, col = Condition, lty = Condition),
lwd = 1.2)+
geom_text(aes(y = AP.Mean+0.1,
label= round(AP.Mean,2)))
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
Erotic_picture_love <- jjstat::Erotic_picture_love
Erotic_picture_love  %>%  str()
knitr::opts_chunk$set(
echo = TRUE,
message = FALSE,
warning = FALSE
#word_document
)
setwd("F:/Rwork/04_Book/book1")
library(rstatix)
# devtools::install_github("shoutjoy/jjstat")
library(jjstat)  # statistical summary
library(knitr)
interplot_data(6,7,4,5, type="plot")
interplot_data(1,4,7,6, type="plot")
interplot_data(2,1,5,3, type="plot")
interplot_data(2,6,5,3, type="plot")
interplot_data(1, 4, 7, 6, type="plot")
interplot_data( 60, 40, 50, 30, 20,20, row = 3, col=2, type="plot" ,
xy = FALSE, yadd=5)
Erotic_picture_love <- jjstat::Erotic_picture_love
Erotic_picture_love  %>%  str()
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
mutate_if(is.numeric, round, 2) %>%
interplot(hjust = 0,
xy= T,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
mutate_if(is.numeric, round, 2) %>%
interplot(hjust = 0,
xy= T, vjust=-1,
xlab = "Gender",
ylab = "AveragePleasantness")+
labs(linetype ="Condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
mutate_if(is.numeric, round, 2) %>%
interplot(hjust = 0,
xy= T, vjust=-1,
xlab = "Gender",
ylab = "AveragePleasantness",
legend_title = "Condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
mutate_if(is.numeric, round, 2) %>%
interplot(hjust = 0,
xy= T, vjust=-1,
xlab = "Gender",
ylab = "AveragePleasantness",
legend_title = "Condition")
# labs(linetype ="Condition")
mysummaryBy(AveragePleasantness ~ Gender + Condition, data = Erotic_picture_love) %>%
# mutate_if(is.numeric, round, 2) %>%
interplot(hjust = 0,
xy= T, vjust=-1,
xlab = "Gender",
ylab = "AveragePleasantness",
legend_title = "Condition")
# labs(linetype ="Condition")
